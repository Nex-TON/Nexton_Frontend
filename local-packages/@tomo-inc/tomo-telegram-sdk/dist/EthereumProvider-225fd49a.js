"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}function t(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t.default=e,t}var r=require("zustand"),n=(e(r),e(require("axios"))),a=require("zustand/middleware"),o=e(require("tonweb")),s=require("viem"),i=require("@ton/core"),u=require("react"),c=(e(u),e(require("qs")));require("uuid");var p=e(require("eventemitter3")),l=require("buffer");function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function f(e,t,r,n,a,o,s){try{var i=e[o](s),u=i.value}catch(e){return void r(e)}i.done?t(u):Promise.resolve(u).then(n,a)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function s(e){f(o,n,a,s,i,"next",e)}function i(e){f(o,n,a,s,i,"throw",e)}s(void 0)}))}}function v(e,t,r){if(k())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var a=new(e.bind.apply(e,n));return r&&_(a,r.prototype),a}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A(n.key),n)}}function g(e,t,r){return t&&m(e.prototype,t),r&&m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function w(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(){return(x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_(e,t)}function k(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(k=function(){return!!e})()}function T(){T=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var o=Object.create((t&&t.prototype instanceof m?t:m).prototype),s=new O(n||[]);return a(o,"_invoke",{value:E(e,r,s)}),o}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var d="suspendedStart",f="executing",h="completed",v={};function m(){}function g(){}function w(){}var x={};c(x,s,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(C([])));b&&b!==r&&n.call(b,s)&&(x=b);var k=w.prototype=m.prototype=Object.create(x);function _(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function r(a,o,s,i){var u=l(e[a],e,o);if("throw"!==u.type){var c=u.arg,p=c.value;return p&&"object"==typeof p&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,s,i)}),(function(e){r("throw",e,s,i)})):t.resolve(p).then((function(e){c.value=e,s(c)}),(function(e){return r("throw",e,s,i)}))}i(u.arg)}var o;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return o=o?o.then(a,a):a()}})}function E(t,r,n){var a=d;return function(o,s){if(a===f)throw Error("Generator is already running");if(a===h){if("throw"===o)throw s;return{value:e,done:!0}}for(n.method=o,n.arg=s;;){var i=n.delegate;if(i){var u=P(i,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===d)throw a=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=f;var c=l(t,r,n);if("normal"===c.type){if(a=n.done?h:"suspendedYield",c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(a=h,n.method="throw",n.arg=c.arg)}}}function P(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=l(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var s=o.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(typeof t+" is not iterable")}return g.prototype=w,a(k,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:g,configurable:!0}),g.displayName=c(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},_(A.prototype),c(A.prototype,i,(function(){return this})),t.AsyncIterator=A,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var s=new A(p(e,r,n,a),o);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},_(k),c(k,u,"Generator"),c(k,s,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return i.type="throw",i.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],i=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var u=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;I(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function _(e,t){return(_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function A(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}function E(e){var t="function"==typeof Map?new Map:void 0;return(E=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return v(e,arguments,y(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_(r,e)})(e)}var P,S=r.create(a.devtools(a.persist((function(e){return{deviceId:void 0,setDeviceId:function(t){return e({deviceId:t})},user:void 0,setUser:function(t){return e({user:t})},transactions:{},setTransactions:function(t){return e({transactions:t})}}}),{name:"tomo-local"}))),I=S,O=function(){try{var e,t=I.getState(),r=null==t?void 0:t.user;return r&&null!=(e=null==r?void 0:r.token)?e:""}catch(e){return""}},C={index:void 0,bot:void 0,tomo:void 0,auth:void 0,pk:void 0,sun:void 0,init:function(e,t,r){var a={bot:e[0]+"moon/",auth:e[0]+"wind/",pk:e[0]+"rain/",sun:e[0]+"sun/",tomo:e[0]+"sky/api/"};this.bot=n.create({baseURL:a.bot}),this.auth=n.create({baseURL:a.auth}),this.pk=n.create({baseURL:a.pk}),this.sun=n.create({baseURL:a.sun}),this.tomo=n.create({baseURL:a.tomo}),[this.index,this.tomo,this.auth,this.bot,this.pk,this.sun].forEach((function(e){e&&e.interceptors.request.use((function(e){Object.defineProperty(e.headers,"X-TOMO-TMA-USERID",{value:t,writable:!0,enumerable:!0,configurable:!0}),Object.defineProperty(e.headers,"X-TOMO-TMA-KEY",{value:r,writable:!0,enumerable:!0,configurable:!0});var n=B();n&&e.baseURL===a.pk&&(e.headers.mfa=n),n&&e.baseURL===a.tomo&&"token/swapList"!=e.url&&(e.headers.mfa=n);var o=O();return o&&"token/swapList"!=e.url&&(e.headers.Authorization="Bearer "+o),e}),(function(e){var t;return console.log("null",e),401===(null==e||null==(t=e.response)?void 0:t.status)?Promise.reject(e):null}))}))}},N=function(e){function t(t,r){var n;return void 0===r&&(r=0),(n=e.call(this,t)||this).name=n.constructor.name,n.code=r,n}return b(t,e),t}(E(Error)),M=function(){var e=h(T().mark((function e(t){var r,n,a,o;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:if((r=e.sent)&&r.data){e.next=6;break}throw new N("Failed to get data",500);case 6:return e.abrupt("return",r.data);case 9:if(e.prev=9,e.t0=e.catch(0),console.error(e.t0),null==e.t0||null==(n=e.t0.response)||null==(n=n.data)||!n.message){e.next=14;break}throw new N(null==e.t0||null==(a=e.t0.response)||null==(a=a.data)?void 0:a.message,null==e.t0||null==(o=e.t0.response)||null==(o=o.data)?void 0:o.code);case 14:throw e.t0;case 15:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=h(T().mark((function e(t){var r,n,a,o;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:if((r=e.sent)&&r.data){e.next=6;break}throw new N("Failed to get data",500);case 6:return e.abrupt("return",r.data);case 9:if(e.prev=9,e.t0=e.catch(0),console.error(e.t0),null==e.t0||null==(n=e.t0.response)||null==(n=n.data)||!n.message){e.next=14;break}throw new N(null==e.t0||null==(a=e.t0.response)||null==(a=a.data)?void 0:a.message,null==e.t0||null==(o=e.t0.response)||null==(o=o.data)?void 0:o.code);case 14:throw e.t0;case 15:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=h(T().mark((function e(t){var r,n,a,o;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:if((r=e.sent)&&r.data){e.next=6;break}throw new N("Failed to get data",500);case 6:return e.abrupt("return",r.data);case 9:if(e.prev=9,e.t0=e.catch(0),console.error(e.t0),null==e.t0||null==(n=e.t0.response)||null==(n=n.data)||!n.message){e.next=14;break}throw new N(null==e.t0||null==(a=e.t0.response)||null==(a=a.data)?void 0:a.message,null==e.t0||null==(o=e.t0.response)||null==(o=o.data)?void 0:o.code);case 14:throw e.t0;case 15:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=h(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:if(1e4==(r=e.sent).code){e.next=5;break}throw new N(r.message,r.code);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){try{var e=localStorage.getItem("tomo_passkey");return null!=e?e:""}catch(e){return null}},U=function(){var e=h(T().mark((function e(t){var r,n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null==(r=C.bot)?void 0:r.get("login?"+t);case 3:return e.abrupt("return",null==(n=e.sent)?void 0:n.data);case 7:if(e.prev=7,e.t0=e.catch(0),console.error(e.t0),401!=e.t0.response.status){e.next=12;break}throw new N(e.t0.response.data,401);case 12:throw e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=h(T().mark((function e(t){var r,n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null==(r=C.bot)?void 0:r.get("session/token",{headers:{"session-code":t}});case 3:return e.abrupt("return",null==(n=e.sent)?void 0:n.data);case 7:if(e.prev=7,e.t0=e.catch(0),console.error(e.t0),401!=e.t0.response.status){e.next=12;break}throw new N("Not logged in",401);case 12:throw e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.pk)?void 0:r.post("v2/reg/"+t,{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.auth)?void 0:r.post("v2/passkey/create/",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.auth)?void 0:r.get("v2/passkey/check/"+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=h(T().mark((function e(t,r){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r={}),e.next=3,M(h(T().mark((function e(){var n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(n=C.pk)?void 0:n.post("v2/sign",t,{headers:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),J=function(){var e=h(T().mark((function e(t,r){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r={}),e.next=3,L(h(T().mark((function e(){var n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(n=C.auth)?void 0:n.post("v2/passkey/validate/",t,{headers:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),G=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.tomo)?void 0:r.post("socialLogin/projectWallet/bitcoin/signPsbtAndPush",t);case 2:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=h(T().mark((function e(t,r){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var n,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O(),e.next=3,null==(n=C.tomo)?void 0:n.post("socialLogin/projectWallet/ethereum/sendTransaction",r,{headers:{Authorization:"Bearer "+a,MFA:t}});case 3:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),H=function(){var e=h(T().mark((function e(t,r){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var n,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O(),e.next=3,null==(n=C.tomo)?void 0:n.post("socialLogin/projectWallet/ethereum/signTransaction",r,{headers:{Authorization:"Bearer "+a,MFA:t}});case 3:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),X=function(){var e=h(T().mark((function e(t,r){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var n,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O(),e.next=3,null==(n=C.tomo)?void 0:n.post("/socialLogin/projectWallet/ton/signTransaction",r,{headers:{Authorization:"Bearer "+a,MFA:t}});case 3:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),F=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.tomo)?void 0:r.post("socialLogin/projectWallet/solana/signRawTransaction",t);case 2:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.tomo)?void 0:r.post("socialLogin/projectWallet/bitcoin/createSendBitcoinPsbt",t);case 2:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.tomo)?void 0:r.post("socialLogin/projectWallet/bitcoin/signMessage",t);case 2:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.tomo)?void 0:r.post("socialLogin/projectWallet/bitcoin/signPsbt",t);case 2:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.tomo)?void 0:r.post("socialLogin/projectWallet/bitcoin/decode",t);case 2:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.pk)?void 0:r.post("v2/reg/"+t,{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.pk)?void 0:r.post("v2/sign",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.auth)?void 0:r.post("v2/passkey/validate/",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.auth)?void 0:r.post("v2/passkey/create/",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.auth)?void 0:r.get("v2/passkey/check/"+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=h(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(h(T().mark((function e(){var t;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=C.auth)?void 0:t.get("v1/payment/passwd/check",{});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.auth)?void 0:r.post("v1/payment/passwd/set",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.auth)?void 0:r.post("v1/payment/passwd/change",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.auth)?void 0:r.post("v1/payment/passwd/validate",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.tomo)?void 0:r.post("socialLogin/projectUser/bindEmailCodeVerify",t);case 2:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.tomo)?void 0:r.get("socialLogin/projectUser/bindEmailCode?email="+t);case 2:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=h(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var t;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=C.tomo)?void 0:t.get("socialLogin/teleGram/wallet/tokens",{});case 2:return e.abrupt("return",e.sent.data);case 4:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=h(T().mark((function e(t,r){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.get(r.url+"wallet/tokens/search",{params:t,headers:{"X-TOMO-TMA-USERID":r.tmaid,"X-TOMO-TMA-KEY":r.tmakey}});case 2:return e.abrupt("return",e.sent.data);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),fe=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.sun)?void 0:r.get("v1/buildTx",{params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.auth)?void 0:r.get("v1/token/balance",{params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.auth)?void 0:r.post("v1/asset/add",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.auth)?void 0:r.get("v1/asset/all",{params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.tomo)?void 0:r.post("socialLogin/mfa/auth/verification",t);case 2:return e.abrupt("return",e.sent.data);case 4:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),we=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(),e.next=3,null==(r=C.tomo)?void 0:r.get("token/swapList",{params:t});case 3:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xe=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.tomo)?void 0:r.get("socialLogin/teleGram/bindEmailCode",{params:t});case 2:return e.abrupt("return",e.sent.data);case 4:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ye=function(){var e=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(r=C.tomo)?void 0:r.post("socialLogin/teleGram/bindEmailCodeVerify",t);case 2:return e.abrupt("return",e.sent.data);case 4:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),be=function(){var e=h(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(h(T().mark((function e(){var t;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=C.tomo)?void 0:t.get("socialLogin/teleGram/userInfo");case 2:return e.abrupt("return",e.sent.data);case 4:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=h(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.get("https://common-service.mobus.workers.dev/chain/all");case 2:return e.abrupt("return",e.sent.data.result);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Te={__proto__:null,successCode:8e3,api:C,GatewayError:N,pkCallback:M,authCallback:L,sunCallback:R,tomoCallback:j,getPassKey:B,loginApi:U,checkLoginByCodeApi:D,pkRegApi:q,pkCreateApi:W,pkCheckApi:V,pkSignApi:K,pkValidateApi:J,btcSignPsbtAndPush:G,sendEvmTransactionApi:z,signEvmTransactionApi:H,tonSignMessage:X,solSignRawTransaction:F,btcCreateSendBtcPsbt:Y,btcSignMessage:Z,btcSignPsbt:$,decodeInfoByHex:Q,v2PkRegApi:ee,v2PkSignApi:te,v2PkValidateApi:re,v2PkCreateApi:ne,v2PkCheckApi:ae,checkPaymentPasswd:oe,setPaymentPasswd:se,changePaymentPasswd:ie,validatePaymentPasswd:ue,bindEmailCodeVerify:ce,bindEmailCodeSend:pe,getSwapAllTokens:le,getSwapAllTokensSearch:de,buildSwapTxApi:fe,getSystemTokens:he,v1AddAssetApi:ve,v1AllAssetApi:me,mfaAuthVerificationApi:ge,getSwapAllTokensV3:we,sendBindEmailCodeApi:xe,verifyBindEmailCodeApi:ye,getTelegramUserInfoApi:be,getConfigChainsAll:ke},_e=function(){var e=h(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={networkType:t.network,addressType:t.addressType,toAddress:t.toAddress,amount:t.amount},e.next=4,Y(r);case 4:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Ae(){return P||(h(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){e(t(require("@solana/web3.js")))}));case 2:P=new e.sent.Connection("https://rpc.ankr.com/solana/ac79e83cf02a544dbb9b3f4c5d5478b2510b921e7d5739ded8791a932e8de0a6","finalized");case 4:case"end":return e.stop()}}),e)})))(),P)}function Ee(){return(Ee=h(T().mark((function e(r,n,a,o){var s,i,u,c,p,l,d;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Ae(),e.next=4,new Promise((function(e){e(t(require("@solana/web3.js")))}));case 4:if(i=new(s=e.sent).Transaction,c=new(u=s.PublicKey)(r),p=new u(n),i.feePayer||(i.feePayer=c),!o){e.next=21;break}return l=new u(o),e.next=14,P.getRecentBlockhash("max");case 14:return i.recentBlockhash=e.sent.blockhash,e.next=17,new Promise((function(e){e(t(require("@solana/spl-token")))}));case 17:i.add(e.sent.createTransferInstruction(l,p,c,a)),e.next=25;break;case 21:return e.next=23,P.getRecentBlockhash("max");case 23:i.recentBlockhash=e.sent.blockhash,i.add(s.SystemProgram.transfer({fromPubkey:c,toPubkey:p,lamports:a}));case 25:return d=i.serialize({requireAllSignatures:!1,verifySignatures:!1}).toString("hex"),e.abrupt("return",d);case 29:return e.prev=29,e.t0=e.catch(0),e.abrupt("return",null);case 32:case"end":return e.stop()}}),e,null,[[0,29]])})))).apply(this,arguments)}function Pe(e,t,r){return Se.apply(this,arguments)}function Se(){return(Se=h(T().mark((function e(r,n,a){var o,s;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){e(t(require("@solana/spl-token")))}));case 2:return o=e.sent,e.next=5,o.getAssociatedTokenAddress(n,a);case 5:return s=e.sent,e.next=8,r.getAccountInfo(s);case 8:if(null!=e.sent){e.next=13;break}return e.abrupt("return",null);case 13:return e.next=15,r.getTokenAccountBalance(s);case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ie=function(){var e=h(T().mark((function e(r){var n,a,o,s,i,u,c,p,l,d,f;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.token,!(n=r.address)){e.next=28;break}return e.next=4,new Promise((function(e){e(t(require("@solana/web3.js")))}));case 4:if(o=e.sent.PublicKey,!a){e.next=19;break}return s=Ae(),i=new o(n),u=new o(a),e.next=11,Pe(s,u,i);case 11:if(null!=(c=e.sent)){e.next=16;break}return e.abrupt("return",{amount:BigInt(0),token:a,format:"0",decimals:void 0});case 16:return e.abrupt("return",{amount:BigInt(c.value.amount),format:c.value.uiAmountString,decimals:c.value.decimals,token:a});case 17:e.next=28;break;case 19:return p=Ae(),l=new o(n),e.next=23,p.getBalance(l);case 23:if(d=e.sent){e.next=26;break}return e.abrupt("return",{balance:"0",formatted:"0"});case 26:return f={balance:""+d,formatted:""+d/Math.pow(10,9)},e.abrupt("return",f);case 28:return e.abrupt("return",void 0);case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Oe(e){var r;return h(T().mark((function n(){var a,o,s;return T().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Promise((function(e){e(t(require("@solana/web3.js")))}));case 2:for(r=new(a=n.sent).TransactionInstruction({programId:new(o=a.PublicKey)(e.programId),data:Buffer.from(e.data),keys:[]}),s=0;s<e.keys.length;s++)r.keys.push({pubkey:new o(e.keys[s].pubkey),isSigner:e.keys[s].isSigner,isWritable:e.keys[s].isWritable});case 6:case"end":return n.stop()}}),n)})))(),r}var Ce=function(){var e=h(T().mark((function e(r){var n,a,o,s,i,u;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){e(t(require("@solana/web3.js")))}));case 2:for(o=new(n=e.sent).TransactionMessage({recentBlockhash:r.tx.recentBlockhash,payerKey:new(a=n.PublicKey)(r.tx.from),instructions:[]}),s=0;s<r.tx.instructions.length;s++)o.instructions.push(Oe(r.tx.instructions[s]));if(!r.tx||"LEGACY"!=r.tx.txType){e.next=12;break}return i=n.Transaction.populate(o.compileToLegacyMessage()),r.tx.signatures.forEach((function(e){i.addSignature(new a(e.publicKey),Buffer.from(e.signature))})),e.abrupt("return",Buffer.from(i.serialize({requireAllSignatures:!1})).toString("hex"));case 12:if(!r.tx||"VERSIONED"!=r.tx.txType){e.next=15;break}return u=n.VersionedTransaction.deserialize(r.tx.serializedMessage),e.abrupt("return",Buffer.from(u.serialize()).toString("hex"));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Ne(){return(Ne=h(T().mark((function e(r,n,a,o){var s,i,u,c,p,l,d,f,h,v,m,g,w,x,y;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Ae(),e.next=3,new Promise((function(e){e(t(require("@solana/web3.js")))}));case 3:return u=(i=e.sent).PublicKey,e.next=7,new Promise((function(e){e(t(require("@solana/spl-token")))}));case 7:if(c=e.sent,p=r&&new u(r),l=n&&new u(n),d=a&&new u(a),!(p&&l&&d&&o)){e.next=45;break}return e.next=14,c.getAssociatedTokenAddress(p,l);case 14:return f=e.sent,e.next=17,s.getAccountInfo(f);case 17:if(null!=e.sent){e.next=21;break}return console.warn("from not token accmount"),e.abrupt("return",null);case 21:return e.next=23,s.getTokenAccountBalance(f);case 23:if(!((h=e.sent).value.amount<o)){e.next=26;break}return e.abrupt("return",null);case 26:return e.t0=i.TransactionMessage,e.t1=l,e.next=30,s.getLatestBlockhash();case 30:return e.t2=e.sent.blockhash,e.t3=[],e.t4={payerKey:e.t1,recentBlockhash:e.t2,instructions:e.t3},v=new e.t0(e.t4),e.next=36,c.getAssociatedTokenAddress(p,d);case 36:return m=e.sent,e.next=39,s.getAccountInfo(m);case 39:return g=e.sent,w=new u("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),null==g&&(x=new u("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"),v.instructions.push(c.createAssociatedTokenAccountInstruction(l,m,d,p,w,x))),v.instructions.push(c.createTransferCheckedInstruction(f,p,m,l,o,h.value.decimals,[],w)),y=new i.VersionedTransaction(v.compileToV0Message()),e.abrupt("return",Buffer.from(y.serialize()).toString("hex"));case 45:return e.abrupt("return",void 0);case 46:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(){return(Me=h(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ae(),e.next=3,P.sendRawTransaction(Buffer.from(t,"hex"));case 3:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Le="1b312c91c3b691255130350a49ac5a0742454725f910756aff94dfe44858388e",Re="https://toncenter.com/api/v2/jsonRPC",je="https://toncenter.com/api/index/v1";function Be(){return Ue.apply(this,arguments)}function Ue(){return(Ue=h(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new o(new o.HttpProvider(Re,{apiKey:Le})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var De="227f87a614319d10e4c20f0f485cd101eca12989bf59da0e33b3c3da8ad534b2",qe="https://testnet.toncenter.com/api/v2/jsonRPC";function We(){return Ve.apply(this,arguments)}function Ve(){return(Ve=h(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new o(new o.HttpProvider(qe,{apiKey:De})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ke=function(){var e=h(T().mark((function e(t){var r,n,a,s,i,u,c,p,l,d;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.tonAddress,n=t.tokenContractAddress,a=t.tokenPrecision,1101!==t.chainId){e.next=7;break}return e.next=4,We();case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,Be();case 9:e.t0=e.sent;case 10:return i=(s=e.t0).wallet.create({address:r}),e.next=14,i.getAddress();case 14:if(u=e.sent,!n){e.next=25;break}return c=new o.token.jetton.JettonMinter(s.provider,{address:n}),e.next=19,c.getJettonWalletAddress(u);case 19:return p=new o.token.jetton.JettonWallet(s.provider,{address:e.sent}),e.next=23,p.getData();case 23:return e.abrupt("return",{balance:l=e.sent.balance,formatted:Number(l.toString())/Math.pow(10,a)});case 25:return e.next=27,s.getBalance(u);case 27:return e.abrupt("return",{balance:d=e.sent,formatted:o.utils.fromNano(d)});case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Je(){return(Je=h(T().mark((function e(t){var r,n,a,u,c,p,l,d,f,h,v,m,g,w,x,y,b,k,_,A;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.formatUnits(t.value,9),e.next=3,Be();case 3:return a=new(0,(n=e.sent).wallet.all.v4R2)(n.provider,{publicKey:n.utils.hexToBytes(t.publicKey),wc:0}),e.next=8,a.methods.seqno().call();case 8:if(e.t0=e.sent,e.t0){e.next=11;break}e.t0=0;case 11:if(c=null,0!=(u=e.t0)){e.next=18;break}return e.next=16,a.createStateInit();case 16:c=e.sent.stateInit;case 18:if(d=i.SendMode.PAY_GAS_SEPARATELY+i.SendMode.IGNORE_ERRORS,!(t.tokenContractAddress&&t.tokenContractAddress.trim().length>0&&t.tokenPrecision)){e.next=49;break}return f=new o.token.jetton.JettonMinter(n.provider,{address:t.tokenContractAddress}),e.next=23,a.getAddress();case 23:return h=e.sent,e.next=26,f.getJettonWalletAddress(h);case 26:return m=new o.token.jetton.JettonWallet(n.provider,{address:(v=e.sent).toString(!0,!0,!1)}),g="string"==typeof t.memo?new Uint8Array([].concat((new TextEncoder).encode(t.memo||"0"))):t.memo,w=Number(r)*Math.pow(10,t.tokenPrecision),x=o.utils.toNano((w/Math.pow(10,9)).toString()),e.next=33,m.createTransferBody({queryId:u,jettonAmount:x,toAddress:new o.utils.Address(t.toAddress),forwardPayload:g,forwardAmount:o.utils.toNano("0.0001"),responseAddress:h});case 33:return y=e.sent,e.next=36,a.createTransferMessage(new Uint8Array,v.toString(!0,!0,!1),o.utils.toNano("0.05"),u,y,d,!0,c);case 36:return b=e.sent,e.next=39,b.signingMessage.toBoc(!1);case 39:if(k=e.sent,!c){e.next=45;break}return e.next=43,c.toBoc(!1);case 43:l=n.utils.bytesToHex(e.sent);case 45:return p=n.utils.bytesToHex(k),e.abrupt("return",{signingMessageBoc:p,stateInitBoc:l});case 49:return _=new o.utils.Address(t.toAddress).toString(!0,!0,!0),e.next=52,n.provider.getAddressInfo(t.toAddress);case 52:return"active"!==e.sent.state&&(_=new o.utils.Address(t.toAddress).toString(!0,!0,!1)),e.next=56,a.createTransferMessage(new Uint8Array,_,o.utils.toNano(r),u,t.memo,d,!0,c);case 56:return A=e.sent,e.next=59,A.signingMessage.toBoc(!1);case 59:if(p=n.utils.bytesToHex(e.sent),!c){e.next=66;break}return e.next=64,c.toBoc(!1);case 64:l=n.utils.bytesToHex(e.sent);case 66:return e.abrupt("return",{signingMessageBoc:p,stateInitBoc:l});case 67:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ge(){return(Ge=h(T().mark((function e(t,r,n){var a,o,s,i;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1101!=n){e.next=6;break}return e.next=3,We();case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,Be();case 8:e.t0=e.sent;case 9:return o=(a=e.t0).boc.Cell.fromBoc(a.utils.base64ToBytes(t))[0],e.t1=a.utils,e.next=14,o.hash();case 14:return e.t2=e.sent,s=e.t1.bytesToBase64.call(e.t1,e.t2),i="",e.next=19,a.provider.sendBoc(t);case 19:return e.abrupt("return",x({},e.sent,{msgHash:s,lt:i}));case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ze(){return(ze=h(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.get(je+"/getTransactionsByInMessageHash?msg_hash="+encodeURIComponent(t)+"&include_msg_body=false&include_block=false",{headers:{"X-API-Key":Le}});case 2:return e.abrupt("return",(null==(r=e.sent)?void 0:r.data)||[]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var He,Xe=function(){function e(){if(this.prefix="tomo-tg-wallet-sdk-",this.userId="","undefined"!=typeof window){var e;if(this.Telegram=window.Telegram,!this.Telegram)throw"[TOMO] please include https://telegram.org/js/telegram-web-app.js in your project";var t=this.Telegram.WebApp.initDataUnsafe||{user:{id:""}},r=(null==t||null==(e=t.user)?void 0:e.id)||"";this.userId=r}}var t=e.prototype;return t.get=function(e,t){if(void 0===t&&(t=!0),"undefined"==typeof window)return null;var r=t?""+this.prefix+e+"_"+this.userId:""+this.prefix+e;try{var n=localStorage.getItem(r);return n?JSON.parse(n):null}catch(e){return console.log(e),null}},t.set=function(e,t,r){if(void 0===r&&(r=!0),"undefined"==typeof window)return null;var n=r?""+this.prefix+e+"_"+this.userId:""+this.prefix+e;try{return localStorage.setItem(n,JSON.stringify(t)),t}catch(e){return null}},e}(),Fe={id:"tomo",version:"1.1.4",name:"Tomo Wallet",homepage:"https://tomo.inc",logo:"",description:"Multi-Chain Wallet based on Telegram, by tomo team 🧑‍🤝‍🧑",downloadLinks:{android:"",googlePlay:"",ios:"",appleStore:"",testflight:"",telegram:"",browserExtension:{chrome:"",edge:""}},deepLinks:{scheme:"tomo://",universallink:"https://",direct_link:"https://t.me/tomowalletbot/tomo_wallet"}},Ye={bridge:"https://bridge.anyconn.org/v1/sub",connect:"https://tg.tomo.inc/bot-server/sdk/signature",connect_direct_link:"https://t.me/tomowalletbot/tomo_wallet"},Ze=["en_US","ru_RU","zh_CN","zh","ar_AE","cs_CZ","de_DE","es_ES","es_LAT","fr_FR","id_ID","it_IT","nl_NL","pl_PL","pt_BR","pt_PT","ro_RO","tr_TR","uk_UA","vi_VN"];(He=exports.CONNECT_MAP||(exports.CONNECT_MAP={})).TOMO_MINI_APP="Tomo Mini App",He.OKX_CONNECT="OKX Connect",He.TON_CONNECT="TON Connect",He.BITGET_WALLET="Bitget Wallet",He.UXUY_WALLET="UXUY";var $e={SOL:[exports.CONNECT_MAP.TOMO_MINI_APP],BTC:[],TON:[exports.CONNECT_MAP.TOMO_MINI_APP,exports.CONNECT_MAP.OKX_CONNECT,exports.CONNECT_MAP.TON_CONNECT],EVM:[exports.CONNECT_MAP.TOMO_MINI_APP,exports.CONNECT_MAP.OKX_CONNECT,exports.CONNECT_MAP.BITGET_WALLET,exports.CONNECT_MAP.UXUY_WALLET]},Qe={decodeTelegramUrlParameters:function(e,t){void 0===t&&(t=!0);var r=e.replaceAll("--","%").replaceAll("__","=").replaceAll("-","&").replaceAll("%5F","_").replaceAll("%2D","-").replaceAll("%2E",".");return t?c.parse(r):r},stringify:function(e){var t=new URLSearchParams;function r(e,n){if(Array.isArray(n))n.forEach((function(n,a){/\[\]$/.test(e)?t.append(e,n):r(e+"["+("object"==typeof n?a:"")+"]",n)}));else if("object"==typeof n)for(var a in n)r(e+"["+a+"]",n[a]);else t.append(e,n)}for(var n in e)r(n,e[n]);return t.toString()},encodeTelegramUrlParameters:function(e,t){return void 0===t&&(t=!0),t&&(e=Qe.stringify(e)),e.replaceAll(".","%2E").replaceAll("-","%2D").replaceAll("_","%5F").replaceAll("&","-").replaceAll("=","__").replaceAll("%","--")},opendeepLink:function(e,t){var r=t.domain,n=t.appname,a="tg://resolve?domain="+(void 0===r?"tomowalletbot":r)+"&mode=compact&appname="+(void 0===n?"app":n)+"&startapp="+e,o=document.getElementById("tgme_frame_cont")||document.body,s=document.createElement("iframe");o.appendChild(s);var i=!1;window.addEventListener("visibilitychange",(function(){i=document.hidden||document.webkitHidden||document.mozHidden||document.msHidden}),!1),window.addEventListener("pagehide",(function(){i=!0}),!1),window.addEventListener("blur",(function(){i=!0}),!1),null!==s&&(s.src=a),setTimeout((function(){i||(window.location=a)}),2e3)},getDeepLink:function(e){var t=e.params,r=e.mode,n=void 0===r?"compact":r,a=e.tMeUrl.match(/t\.me\/([^\/]+)\/([^\/]+)/),o=a[1],s=a[2],i=t?this.encodeTelegramUrlParameters(t):"",u="tg://resolve?domain="+o+"&mode="+n+"&appname="+s;return i?u+"&startapp="+i:u}};function et(e){var t=window.location.hostname;try{var r;t=(null==(r=new URL((null==e?void 0:e.url)||""))?void 0:r.hostname)||t}catch(t){console.warn("new URL("+(null==e?void 0:e.url)+") error")}return{url:(null==e?void 0:e.url)||"",hostname:t,name:(null==e?void 0:e.name)||"DApp",icon:(null==e?void 0:e.icon)||tt(window),direct_link:null==e?void 0:e.direct_link,description:null==e?void 0:e.description}}function tt(e){for(var t=e.document.querySelectorAll('head > link[rel~="icon"]'),r=0,n=Array.from(t);r<n.length;r++){var a=n[r];if(a)return a.href}return null}function rt(){return function(e){return e}}var nt,at,ot=rt(),st=rt(),it=rt(),ut=rt(),ct={EVM:"evm",SOL:"sol",TON:"ton"};(nt=exports.TonTxBodyType||(exports.TonTxBodyType={})).JETTON_PAYLOAD_JSON_LEGACY="JETTON_PAYLOAD_JSON_LEGACY",nt.STANDARD="STANDARD",(at=exports.TomoProviderEventName||(exports.TomoProviderEventName={})).TOMO_EVM_PROVIDER_DISCONNECTED="TOMO_EVM_PROVIDER_DISCONNECTED",at.TOMO_EVM_PROVIDER_CONNECTED="TOMO_EVM_PROVIDER_DISCONNECTED";var pt=function(e){return"'ToMoWallet: Timed out while waiting for response from '"+e+"'."},lt={rpc:{timeoutRequest:-30008,invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{unsupportedChain:4002,userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}},dt={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}},ft=function(e){var t=e.code,r=e.message,n=e.data;return{code:t=(t||lt.rpc.invalidRequest).toString(),message:r||dt[t].message||"Unspecified error message. This is a bug, please report it.",data:n}},ht={config:{accounts:{eth:{address:"",alliance:"evm",name:"",chainId:void 0,symbol:""}}},hash:"",salt:"",signature:"",id:"",method:"",params:[],result:[],options:{account:{address:"",alliance:"evm",name:"",chainId:void 0,symbol:"",chainKey:"",chainName:"",chainSymbol:""},metaData:{hostname:"",icon:"",name:"",url:""}}},vt=function(e,t,r,n){void 0===r&&(r="EVM"),void 0===n&&(n=!1);var a,o,s,i=x({},ht);if(i.hash=e.hash,i.salt=e.salt,i.signature=e.signature,i.id=e.id,i.method=e.method,i.params=e.params,1e4!==t.code)throw new Error(JSON.stringify(t));return i.config.accounts="EVM"===r?{eth:{address:null!=(o=t.result.defaultEthereumAddress)?o:t.result.v2Address,alliance:"evm",name:"ethereum",chainId:1,symbol:"ETH"}}:gt(r,n?t.result.user:t.result,null==(s=e.params)||null==(s=s[0])?void 0:s.chainId),i.result="EVM"===r?[null!=(a=t.result.defaultEthereumAddress)?a:t.result.v2Address]:i.config.accounts[r.toLowerCase()],n&&(i.result.tonProof=t.result.tonProof,i.result.stateInit=t.result.stateInit),i.options.account=i.config.accounts["EVM"===r?"eth":r.toLowerCase()],i},mt=function(e,t,r,n){void 0===n&&(n="EVM");var a,o=x({},ht);return o.config.accounts="EVM"===n?{eth:r}:((a={})[n.toLowerCase()]=r,a),o.hash=e.hash,o.salt=e.salt,o.signature=e.signature,o.id=e.id,o.method=e.method,o.params=e.params,o.result=null!=t?t:{code:-1,message:"Network error",result:void 0},o.options.account=o.config.accounts["EVM"===n?"eth":n.toLowerCase()],o},gt=function(e,t,r){var n;switch(e){case"BTC":return{btc:{address:t.defaultBtcAddress,alliance:"btc",name:"bitcoin",chainId:r||0,symbol:"BTC"}};case"SOL":return{sol:{address:t.solanaAddress,alliance:"sol",name:"solana",chainId:r||501,symbol:"SOL"}};case"TON":return{ton:{address:1101===r?t.tonAddressTest:t.tonAddress,publicKey:t.tonPublicKey,alliance:"ton",name:"ton",chainId:r||1100,symbol:"TON"}};case"SUI":return{sui:{address:t.suiAddress,alliance:"sui",name:"sui",chainId:r||784,symbol:"SUI"}};default:return{eth:{address:null!=(n=t.defaultEthereumAddress)?n:t.v2Address,alliance:"evm",name:"ethereum",chainId:1,symbol:"ETH"}}}};function wt(e){return void 0===e&&(e=0),"0x"+(e=isNaN(Number(e))?1:Number(e)).toString(16)}var xt=function(){var e=new Map;return function(t,r,n){if(void 0===n&&(n=1e3),e.has(t))return e.get(t);var a=r();return e.set(t,a),setTimeout((function(){e.delete(t)}),n),a.finally((function(){e.delete(t)}))}}(),yt={address:"",chainId:"0x1",chainKey:"ethereum",alliance:ct.EVM,chainName:"Ethereum netWork",chainSymbol:"ETH"},bt=function(e){function t(t){var r;return(r=e.call(this)||this)._isRetryCount=0,r.eventTimeout=(null==t?void 0:t.eventTimeout)||6e5,r.metaData=null==t?void 0:t.metaData,r.storage=new Xe,r.connectUrl=t.connect,r.bridgeUrl=t.bridge,r.connect_direct_link=t.connect_direct_link,r}b(t,e);var r=t.prototype;return r.request=function(){var e=h(T().mark((function e(t){var r,n,a,o,s,i=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(r=t||{}).method,o=void 0===(a=r.params)?[]:a,t&&"object"==typeof t&&!Array.isArray(t)){e.next=3;break}throw ft({message:"Expected a single, non-array, object argument.",data:o});case 3:if("string"==typeof n&&0!==n.length){e.next=5;break}throw ft({message:"'args.method' must be a non-empty string.",data:t});case 5:return s=n+"-"+JSON.stringify(o||[]),e.abrupt("return",xt(s,(function(){return i.connectSse(n,o)})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.getSseToken=function(){var e=h(T().mark((function e(t,r,a){var o,s,i,u,c,p,l;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this._account,s=(new Date).getTime(),this._lastTime=s,a=x({account:o,metaData:et(this.metaData)},a,{timeStamp:s}),i=(new Date).getTime()+Math.floor(1e3*Math.random()).toString(),u="salt-"+Date.now()+"-"+i,u=Buffer.from(u,"utf-8").toString("base64").replace("==","").replace("=",""),p={id:(c={id:i,method:t,params:r,options:a}).id,data:c,version:"1.0",salt:u},e.next=11,n.post(this.connectUrl,{payload_base64:Buffer.from(JSON.stringify(p),"utf-8").toString("base64")},{headers:{"X-Salt":u}});case 11:return e.abrupt("return",{hash:(l=e.sent.data).hash,signature:l.signature,salt:u});case 14:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),r.connectSse=function(){var e=h(T().mark((function e(t,r,n){var a,o,s,i,u,c;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSseToken(t,r,n);case 2:return u={method:t,params:[o=(a=e.sent).salt,s=a.hash,i=a.signature]},c=(new Date).getTime()+Math.floor(1e3*Math.random()).toString(),e.abrupt("return",this.createEventSource(s,i,o,u,{id:c,method:t,params:r,options:n,hash:s,signature:i,salt:o}));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),r.createEventSource=function(e,t,r,n,a){var o=this,s=new EventSource(this.bridgeUrl+"?appid="+e+"&signature="+t+"&salt="+r);return new Promise((function(i,u){var c=o.eventTimeout>0?setTimeout((function(){var e;u(ft({code:null==lt||null==(e=lt.rpc)?void 0:e.timeoutRequest,message:pt(a.method),data:a})),s.close()}),o.eventTimeout||6e4):null;s.addEventListener("message",(function(p){if("hi"!==(null==p?void 0:p.data)&&"close"!==(null==p?void 0:p.data)){if(null==p||!p.data){if(o._isRetryCount+=1,s.close(),clearTimeout(c),o._isRetryCount>4)throw o._isRetryCount=0,new Error("Tomo Wallet Request error");return o.createEventSource(e,t,r,n,a)}var l=a.method.split("_"),d=l[0],f=l[1];try{var h,v,m=atob(null==p?void 0:p.data),g=JSON.parse(m),w=o.storage.get("account");if(f.includes("connect")){var y,b,k=null==(y=a.params[0])?void 0:y.tonProof;g=vt(a,g,d.toUpperCase(),k),o.storage.set("account",g.options.account),o.storage.set("accounts",x({},o.storage.get("accounts")||{},((b={})[d.toLowerCase()]=g.options.account,b)))}else g=mt(a,g,w,d);return(null==(h=g)?void 0:h.id)==a.id||r==(null==(v=g)?void 0:v.salt)?(null==s||s.close(),clearTimeout(c),!g.reConnect&&g.error||kt.call(o,g),o._isRetryCount=0,void(g.error?u(g.error):i(x({},g.result)))):console.log("Tomo wallet data error")}catch(e){console.log(e),u(e)}}})),o.openAuthBot(n)}))},r.openAuthBot=function(e){var t=JSON.stringify({method:e.method,params:e.params}),r=(new TextEncoder).encode(t),n=btoa(String.fromCharCode.apply(String,r));if(!this._isRetryCount){var a,o=window.Telegram;if(!o)throw"[TOMO] please include https://telegram.org/js/telegram-web-app.js in your project";if(o.WebApp.initData&&(null==o||null==(a=o.WebApp)||null==a.openTelegramLink||a.openTelegramLink(this.connect_direct_link+"?startapp="+n+"&mode=compact")),!o.WebApp.initData){var s=this.connect_direct_link.match(/t\.me\/([^\/]+)\/([^\/]+)/);s[1]&&s[2]?!o.WebApp.initData&&Qe.opendeepLink(n,{domain:s[1],appname:s[2]}):!o.WebApp.initData&&Qe.opendeepLink(n,{})}}},r.getAppInfo=function(){return x({},Fe)},r.removeAccount=function(e){var t;this._accounts=x({},this._accounts,((t={})[e]=null,t))},r.getMethodInfo=function(e){return e.split("_")||[]},g(t,[{key:"_lastTime",get:function(){return isNaN(Number(this.storage.get("lastTime")||0))?0:Number(this.storage.get("lastTime")||0)},set:function(e){this.storage.set("lastTime",e)}},{key:"_account",get:function(){return this.storage.get("account")||yt},set:function(e){var t,r,n,a,o,s,i=x({},this._account||yt);e||(e=x({},i,{address:""})),this.storage.set("account",e),wt(null==i?void 0:i.chainId)!=wt(null==(t=e)?void 0:t.chainId)&&(this.emit("chainChanged",null==this?void 0:this.chainId,null==(n=e)?void 0:n.alliance,e),this.emit("networkChanged",parseInt(null==this?void 0:this.chainId),null==(a=e)?void 0:a.alliance)),(null==i?void 0:i.address)!=(null==(r=e)?void 0:r.address)&&this.emit("accountsChanged",null!=(o=e)&&o.address?[null==(s=e)?void 0:s.address]:[])}},{key:"_accounts",get:function(){return this.storage.get("accounts")||{ethereum:yt}},set:function(e){this.storage.set("accounts",e)}},{key:"chainId",get:function(){var e,t;return null!=(e=this._account)&&e.chainId?wt(null==(t=this._account)?void 0:t.chainId):null}}])}(p);function kt(e){var t=(e||{}).config;if(t){var r=null==t?void 0:t.accounts;return r&&(this._accounts=x({},this._accounts||{},r)),e}}function Tt(e){try{e="string"==typeof e?JSON.parse(e):e}catch(e){console.log("EIP712Data is not a valid JSON string")}try{e=function(e){var t={};for(var r in{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}})e[r]&&(t[r]=e[r]);return"types"in t&&(t.types=Object.assign({EIP712Domain:[]},t.types)),t}(e);var t={};return e.types[e.primaryType].map((function(r){var n=r.name;t[n]=e.message[n]})),e.message=t,e}catch(e){console.error("parseEIP712 error")}return e}function _t(e){return void 0===e&&(e=""),42===e.length}var At=function(e){function t(t){var r,n=t.protocol;return(r=e.call(this)||this).protocol=n,r._initializeChannelMessage(),r}return b(t,e),t.prototype._initializeChannelMessage=function(){},t}(p);function Et(e){return void 0===e&&(e=0),"0x"+(e=isNaN(Number(e))?1:Number(e)).toString(16)}var Pt={address:"",chainId:"0x1",chainKey:"ethereum",alliance:ct.EVM,chainName:"Ethereum netWork",chainSymbol:"ETH"};function St(){return(St=h(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.get("https://d13t1x9bdoguib.cloudfront.net/static/chainList.json");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var It=function(){function e(e){this.options=e,this.rpcMap=new Map,this.peddingMap=new Map,(null==e?void 0:e.chainId)&&this.setUrl(e.url,e.chainId)}var t=e.prototype;return t.setUrl=function(e,t){this.rpcMap.set(parseInt(t),e)},t.getUrl=function(e){return this.rpcMap.get(parseInt(e))},t.send=function(){var e=h(T().mark((function e(t,r){var a,o,s,i,u,c,p;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.method,o=t.params,s=t.id,i=r.rpcUrl||this.getUrl(r.chainId),u={jsonrpc:"2.0",method:a,params:o,id:s||(new Date).getTime()},e.next=5,n.post(i,u);case 5:if(!(p=(c=e.sent).data.error)){e.next=9;break}throw p;case 9:return e.abrupt("return",c.data.result);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.sendBatch=function(){var e=h(T().mark((function e(t,r){var n,a,o,s;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===r&&(r={}),n=[],a=w(t);case 3:if((o=a()).done){e.next=11;break}return s=o.value,e.next=7,this.send(s,r);case 7:n.push(e.sent);case 9:e.next=3;break;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),e}(),Ot=function(){function e(){this.prefix="tomo-tg-wallet-"}var t=e.prototype;return t.get=function(e){try{var t=localStorage.getItem(""+this.prefix+e);return t?JSON.parse(t):null}catch(e){return console.log(e),null}},t.set=function(e,t){try{return localStorage.setItem(""+this.prefix+e,JSON.stringify(t)),t}catch(e){return null}},e}();function Ct(e){var t,r,n=e||{},a=n.method,o=n.config,s=(null==o||null==(t=o.params)?void 0:t[0])||{};if(o){var i=null==o?void 0:o.accounts;switch(i&&(this._accounts=i),a){case"wallet_switchEthereumChain":case"wallet_addEthereumChain":var u=Object.values(this._accounts||{}).find((function(e){return Et(e.chainId)===Et(s.chainId)}));u?this._account=x({},u):e.error={code:-32602,message:"tomo wallet does not support  "+(null==s?void 0:s.chainId)};break;case"eth_requestAccounts":this._account=this._accounts[null==(r=this._account)?void 0:r.chainKey]||Object.values(this._accounts)[0]}return e}}var Nt=function(){var e=new Map;return function(t,r,n){if(void 0===n&&(n=1e3),e.has(t))return e.has(t);var a=r();return e.set(t,a),setTimeout((function(){e.delete(t)}),n),a.finally((function(){e.delete(t)}))}}(),Mt=function(e){function t(t){var r,n;return(n=e.call(this,{protocol:ct.EVM})||this).autoRefreshOnNetworkChange=!0,n._isMetaMask=!0,n.isMetaMask=!0,n._isConnected=!1,n.isTomoWallet=!0,n._isRetryCount=0,n.chainList=[],n.overrideRpcUrl={},t.overrideRpcUrl&&(n.overrideRpcUrl=t.overrideRpcUrl),n.utils=new bt(x({},Ye,t)),n.version=n.getAppInfo().version,n.connectUrl=t.connect||Ye.connect,n.bridgeUrl=t.bridge||Ye.bridge,n.connect_direct_link=t.connect_direct_link||Ye.connect_direct_link,n.eventTimeout=(null==t?void 0:t.eventTimeout)||6e5,n.metaData=t.metaData,n.storage=new Ot,n.httpProvider=new It({chainId:"0x1",url:"https://rpc.ankr.com/eth"}),n._initialize(),function(){return St.apply(this,arguments)}().then((function(e){return n.chainList=e.data})).catch((function(){})),"undefined"==typeof window||null!=(r=window)&&r.ethereum||!t.injected||(window.ethereum=n,console.log("injected in evm provider"),dispatchEvent(new Event("ethereum#initialized"))),n}b(t,e);var r=t.prototype;return r.checkIsChainSupported=function(e){var t=Number(e);return!!this.chainList.find((function(e){return e.id===t}))},r._initialize=function(){this.emit("connect",{chainId:null==this?void 0:this.chainId}),this.emit("_initialized")},r._walletSwitchChain=function(){var e=h(T().mark((function e(t){var r,n,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(r=t.params)[0],a=Object.values(this._accounts||{}).find((function(e){return Et(e.chainId)===Et(n.chainId)}))){e.next=9;break}return e.next=6,this.request({method:"eth_requestAccounts"});case 6:if(a=Object.values(this._accounts||{}).find((function(e){return Et(e.chainId)===Et(n.chainId)}))){e.next=9;break}throw ft({code:lt.provider.unsupportedChain,message:(o=null==n?void 0:n.chainId.toString(),"'ToMoWallet: not supported chain with ID '"+o+"'. try connect wallet to supported chain."),data:r});case 9:return this._account=a,e.abrupt("return",null);case 11:case"end":return e.stop()}var o}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.getAppInfo=function(){return x({},Fe)},r.enable=function(){var e=h(T().mark((function e(){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request({method:"eth_requestAccounts"}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.getRpcUrl=function(){var e=this,t=this.chainList.find((function(t){return t.id===Number(e.chainId)})).rpcUrl;return this.overrideRpcUrl[+this.chainId]&&(t=this.overrideRpcUrl[+this.chainId]),t},r.request=function(){var e=h(T().mark((function e(t){var r,n,a,o,s,i,u,c,p,l,d,f,h,v,m=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(a=t||{}).method,i=void 0===(s=a.params)?[]:s,t&&"object"==typeof t&&!Array.isArray(t)){e.next=3;break}throw ft({message:"Expected a single, non-array, object argument.",data:i});case 3:if("string"==typeof o&&0!==o.length){e.next=5;break}throw ft({message:"'args.method' must be a non-empty string.",data:t});case 5:e.prev=5,u=o+"-"+JSON.stringify(i||[]),e.t0=o,e.next="wallet_requestPermissions"===e.t0?10:"eth_requestAccounts"===e.t0?11:"eth_accounts"===e.t0?15:"eth_chainId"===e.t0?16:"wallet_switchEthereumChain"===e.t0||"wallet_addEthereumChain"===e.t0?17:"wallet_watchAsset"===e.t0||"metamask_watchAsset"===e.t0?23:"personal_sign"===e.t0||"eth_signETHTransaction"===e.t0||"eth_signErc20Transaction"===e.t0||"eth_signTypedData"===e.t0||"eth_signTransaction"===e.t0?24:"eth_sendTransaction"===e.t0?28:"eth_signTypedData_v3"===e.t0||"eth_signTypedData_v4"===e.t0?37:44;break;case 10:throw"wallet_requestPermissions not supported";case 11:if(g=this._lastTime,void 0===(w=this.eventTimeout)&&(w=9e5),c=(new Date).getTime()-g>w,null==this||null==(r=this._account)||!r.address||c){e.next=14;break}return e.abrupt("return",[this._account.address]);case 14:return e.abrupt("return",Nt(u,(function(){return m._request(o,i)})));case 15:return e.abrupt("return",[null==(n=this._account)?void 0:n.address]);case 16:return e.abrupt("return",this.chainId);case 17:if(this.connected){e.next=20;break}return e.next=20,this.request({method:"eth_requestAccounts"});case 20:return this.utils.storage.set("evm_chainId",i[0].chainId),e.abrupt("return",null);case 23:return e.abrupt("return",Nt(u,(function(){return m._request(o,i)})));case 24:if(this.connected){e.next=27;break}return e.next=27,this.request({method:"eth_requestAccounts"});case 27:return e.abrupt("return",Nt(u,(function(){return m._request(o,i)})));case 28:return(l=(p=i[0]).chainId)||(l=this.chainId),e.next=33,this.request({method:"eth_signTransaction",params:[x({},p,{chainId:l})]});case 33:return d=e.sent,f=this.getRpcUrl(),e.abrupt("return",this.httpProvider.send({method:"eth_sendRawTransaction",params:[d.result]},{chainId:l,chainKey:this.chainKey,rpcUrl:f}));case 37:if(this.connected){e.next=40;break}return e.next=40,this.request({method:"eth_requestAccounts"});case 40:return h=t.params[0],_t(t.params[0])&&!_t(t.params[1])&&(h=t.params[1]),i[0]=Tt(h),e.abrupt("return",Nt(u,(function(){return m._request(o,i)})));case 44:return v=this.getRpcUrl(),e.abrupt("return",this.httpProvider.send(t,{chainId:this.chainId,chainKey:this.chainKey,rpcUrl:v}));case 46:e.next=52;break;case 48:return e.prev=48,e.t1=e.catch(5),console.log(e.t1),e.abrupt("return",Promise.reject("object"==typeof e.t1?e.t1:{code:-32603,message:e.t1}));case 52:case"end":return e.stop()}var g,w}),e,this,[[5,48]])})));return function(t){return e.apply(this,arguments)}}(),r._createEventSource=function(){var e=h(T().mark((function e(t,r,n,a,o){var s,i=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new EventSource(this.bridgeUrl+"?appid="+t+"&signature="+r+"&salt="+n),e.abrupt("return",new Promise((function(e,u){var c=i.eventTimeout>0?setTimeout((function(){var e;u(ft({code:null==lt||null==(e=lt.rpc)?void 0:e.timeoutRequest,message:pt(a.method),data:a.params})),s.close()}),i.eventTimeout||6e4):null;s.addEventListener("message",(function(p){if("hi"!==(null==p?void 0:p.data)&&"close"!==(null==p?void 0:p.data)){if(null==p||!p.data){if(i._isRetryCount+=1,s.close(),clearTimeout(c),i._isRetryCount>4)throw i._isRetryCount=0,new Error("Tomo Wallet Request error");return i._createEventSource(t,r,n,a,o)}try{var l,d,f=atob(null==p?void 0:p.data),h=JSON.parse(f);if("eth_requestAccounts"===o.method||"wallet_requestPermissions"===o.method)h=vt(o,h);else if("eth_signETHTransaction"===o.method||"eth_signTransaction"===o.method)h=mt(o,h,i._account);else if("personal_sign"===o.method){var v=i._account;console.log("personal_sign data",h),h=mt(o,h.result,v)}else"eth_signErc20Transaction"===o.method&&(h=mt(o,h,i._account));(null==(l=h)?void 0:l.id)==o.id||n==(null==(d=h)?void 0:d.salt)?(null==s||s.close(),clearTimeout(c),!h.reConnect&&h.error||Ct.call(i,h),i._isRetryCount=0,h.error?u(h.error):e(h.result)):console.log("Tomo wallet data error")}catch(e){console.log(e)}}})),i.utils.openAuthBot(a)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,o){return e.apply(this,arguments)}}(),r._request=function(){var e=h(T().mark((function e(t,r,a){var o,s,i,u,c,p,d,f,h,v,m;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this._account,s=(new Date).getTime(),this._lastTime=s,a=x({account:o,metaData:et(this.metaData)},a,{timeStamp:s}),i=(new Date).getTime()+Math.floor(1e3*Math.random()).toString(),u="salt-"+Date.now()+"-"+i,u=l.Buffer.from(u,"utf-8").toString("base64").replace("==","").replace("=",""),p={id:(c={id:i,method:t,params:r,options:a}).id,data:c,version:"1.0",salt:u},e.next=11,n.post(this.connectUrl,{payload_base64:l.Buffer.from(JSON.stringify(p),"utf-8").toString("base64")},{headers:{"X-Salt":u}});case 11:return v={method:t,params:[u,f=(d=e.sent.data).hash,h=d.signature]},m=x({},c,{hash:f,signature:h,salt:u}),e.abrupt("return",this._createEventSource(f,h,u,v,m));case 16:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),r.disconnect=function(){this._account=null,this.emit("accountsChanged",[]),this.emit(exports.TomoProviderEventName.TOMO_EVM_PROVIDER_DISCONNECTED,"")},g(t,[{key:"_lastTime",get:function(){return isNaN(Number(this.storage.get("lastTime")||0))?0:Number(this.storage.get("lastTime")||0)},set:function(e){this.storage.set("lastTime",e)}},{key:"_account",get:function(){return this.storage.get("evm_account")||Pt},set:function(e){var t,r,n,a,o,s,i=x({},this._account||Pt);e||(e=x({},i,{address:""})),this.storage.set("evm_account",e),Et(null==i?void 0:i.chainId)!=Et(null==(t=e)?void 0:t.chainId)&&(this.emit("chainChanged",null==this?void 0:this.chainId,null==(n=e)?void 0:n.alliance,e),this.emit("networkChanged",parseInt(null==this?void 0:this.chainId),null==(a=e)?void 0:a.alliance)),(null==i?void 0:i.address)!=(null==(r=e)?void 0:r.address)&&this.emit("accountsChanged",null!=(o=e)&&o.address?[null==(s=e)?void 0:s.address]:[])}},{key:"_accounts",get:function(){return this.storage.get("evm_accounts")||{ethereum:Pt}},set:function(e){this.storage.set("evm_accounts",e)}},{key:"networkVersion",get:function(){return parseInt(this.chainId)}},{key:"chainId",get:function(){return Et(this.utils.storage.get("evm_chainId"))}},{key:"chainKey",get:function(){var e;return(null==(e=this._account)?void 0:e.chainKey)||(null==Pt?void 0:Pt.chainKey)}},{key:"connected",get:function(){var e;return!(null==(e=this._account)||!e.address)}},{key:"selectedAddress",get:function(){var e;return(null==(e=this._account)?void 0:e.address)||""}},{key:"isConnected",get:function(){return this.connected}}])}(At);exports.AddressString=st,exports.AppInfo=Fe,exports.BASE_URL=Ye,exports.BigIntString=it,exports.ChainIdWithConnectsMap=$e,exports.EthereumProvider=Mt,exports.HexString=ot,exports.IntNumber=function(e){return Math.floor(e)},exports.OpaqueType=rt,exports.PROVIDER_ALLIANCE=ct,exports.ProviderUtils=bt,exports.ProxyLocalStorage=Xe,exports.RegExpString=ut,exports.ToSerializeTransaction=Ce,exports._asyncToGenerator=h,exports._createClass=g,exports._extends=x,exports._inheritsLoose=b,exports._objectWithoutPropertiesLoose=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r},exports._regeneratorRuntime=T,exports.api=C,exports.apiList=Te,exports.btcAddressTypeMaps=["bitcoinP2Wpkh","bitcoinP2Sh","bitcoinP2Tr","bitcoinP2Pkh"],exports.btcDecimals=8,exports.btcSignPsbtAndPush=G,exports.buildSwapTxApi=fe,exports.changePaymentPasswd=ie,exports.checkLoginByCodeApi=D,exports.checkPaymentPasswd=oe,exports.createSigningTransaction=function(e){return Je.apply(this,arguments)},exports.getConfigChainsAll=ke,exports.getConnection=Ae,exports.getDeviceId=function(){try{var e=I.getState();return(null==e?void 0:e.deviceId)||""}catch(e){return""}},exports.getDisplayDescription=function(e){var t;return((t={"Tomo Mini App":"Multichain","OKX Connect":"TG & App","TON Connect":"","EVM Connect":""})[exports.CONNECT_MAP.BITGET_WALLET]="mini app",t[exports.CONNECT_MAP.UXUY_WALLET]="mini app",t)[e]||""},exports.getDisplayName=function(e){var t;return((t={"Tomo Mini App":"Tomo Wallet","OKX Connect":"OKX Wallet","TON Connect":"TON Wallets","EVM Connect":"EVM Wallets"})[exports.CONNECT_MAP.BITGET_WALLET]="Bitget Wallet",t[exports.CONNECT_MAP.UXUY_WALLET]="UXUY Wallet",t)[e]||e},exports.getOkxLanguage=function(e){return void 0===e&&(e="en_US"),Ze.includes(e)?e:"en_US"},exports.getSendSplToken=function(e,t,r,n){return Ne.apply(this,arguments)},exports.getSolBalance=Ie,exports.getSwapAllTokensSearch=de,exports.getSwapAllTokensV3=we,exports.getSystemTokens=he,exports.getTelegramUserInfoApi=be,exports.getTonBalance=Ke,exports.getTransactionsByInMessageHash=function(e){return ze.apply(this,arguments)},exports.isIOS=function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},exports.isPcBrowser=function(){return!/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&!/Telegram/i.test(navigator.userAgent)},exports.loginApi=U,exports.mfaAuthVerificationApi=ge,exports.mockBtcEvmChainId=0,exports.mockEvmChainIds={SOL:501,BTC:0,TON:1100},exports.mockSolEvmChainId=501,exports.mockTonChainId=1100,exports.mockTonTestnetChainId=1101,exports.passkeyKey="tomo_passkey",exports.pkCheckApi=V,exports.pkCreateApi=W,exports.pkRegApi=q,exports.pkSignApi=K,exports.pkValidateApi=J,exports.sendBindEmailCodeApi=xe,exports.sendSolTx=function(e,t,r,n){return Ee.apply(this,arguments)},exports.sendTransaction=function(e,t,r){return Ge.apply(this,arguments)},exports.sendTransaction$1=function(e){return Me.apply(this,arguments)},exports.sendTx=_e,exports.setPaymentPasswd=se,exports.signEvmTransactionApi=H,exports.solDecimals=9,exports.solSignRawTransaction=F,exports.successCode=8e3,exports.tonDecimals=9,exports.tonSignMessage=X,exports.useLocalStore=S,exports.useProxyLocalStorage=function(){var e=u.useState({get:function(){return console.warn("local storage proxy not created yet"),""},set:function(){return console.warn("local storage proxy not created yet"),""}}),t=e[0],r=e[1];return u.useEffect((function(){r(new Xe)}),[]),t},exports.v1AddAssetApi=ve,exports.v1AllAssetApi=me,exports.validatePaymentPasswd=ue,exports.verifyBindEmailCodeApi=ye;
//# sourceMappingURL=EthereumProvider-225fd49a.js.map
